<!doctype html>
<html lang="en">
  <head>
  <meta name="charset" content="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="プログラミング言語 Nim は C, C++ と JavaScript へ コンパイルを行える簡潔で高速なプログラミング言語です。">
  <meta charset="utf-8">
  <link rel="icon" type="image/png" href="/assets/img/logo_bw.png" />

  
  <title>Version 0.9.4 released - Nim ブログ</title>
  
  <link rel="stylesheet" href="/assets/css/pure.min.css">
  <link rel="stylesheet" href="/assets/css/pure-grids-responsive.min.css">
  <link href="https://use.fontawesome.com/releases/v5.0.2/css/all.css" rel="stylesheet">
  <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->
  
  <link rel="stylesheet" href="/assets/css/highlight/github.css">
  

  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Open+Sans|Titillium+Web" rel="stylesheet">
  <link rel="stylesheet" href="/assets/css/main.css?t=1575086493317106700">

  <meta name="twitter:title" content="Version 0.9.4 released">

  
  <meta name="twitter:description" content="The Nimrod development community is proud to announce the release of version 0.9.4 of the Nimrod compiler and tools. Note: This release has to be considered beta quality! Lots of new features have been implemented but unfortunately some do not fulfill our quality standards yet.">
  <meta property="og:description" content="The Nimrod development community is proud to announce the release of version 0.9.4 of the Nimrod compiler and tools. Note: This release has to be considered beta quality! Lots of new features have been implemented but unfortunately some do not fulfill our quality standards yet.">
  

  <meta name="twitter:site" content="@nim_lang">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://nim-lang.org/assets/img/twitter_banner.png">

  <meta property="og:title" content="Version 0.9.4 released" />
  <meta property="og:site_name" content="プログラミング言語 Nim (非公式日本語β版)" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://nim-lang.org/assets/img/twitter_banner.png" />
  <meta property="og:image:type" content="image/png" />
  <meta property="og:image:width" content="1000" />
  <meta property="og:image:height" content="500" />
  <meta property="og:image:alt" content="プログラミング言語 Nim" />
</head>

  <body class="site">
    <header>
  <nav class="pure-menu pure-menu-horizontal pure-menu-scrollable">
    <div class="nav-content">
      <a href="/" class="pure-menu-heading pure-menu-link site-logo-container">
        <img class="site-logo" src="/assets/img/logo.svg" height="28" alt="Nim">
      </a>
      <ul class="pure-menu-list">
        
        <li class="pure-menu-item">
          <a href="/blog.html"
             class="pure-menu-link ">
            ブログ
          </a>
        </li>
        
        <li class="pure-menu-item">
          <a href="/features.html"
             class="pure-menu-link ">
            特徴
          </a>
        </li>
        
        <li class="pure-menu-item">
          <a href="/install.html"
             class="pure-menu-link ">
            ダウンロード
          </a>
        </li>
        
        <li class="pure-menu-item">
          <a href="/learn.html"
             class="pure-menu-link ">
            学ぶ
          </a>
        </li>
        
        <li class="pure-menu-item">
          <a href="/documentation.html"
             class="pure-menu-link ">
            資料
          </a>
        </li>
        
        <li class="pure-menu-item">
          <a href="https://forum.nim-lang.org"
             class="pure-menu-link ">
            フォーラム
          </a>
        </li>
        
        <li class="pure-menu-item">
          <a href="/donate.html"
             class="pure-menu-link ">
            寄付
          </a>
        </li>
        
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="https://github.com/nim-lang/Nim">ソース</a>
        </li>
      </ul>
    </div>
    <div class="menu-fade"></div>
  </nav>
</header>

    <div class="site-content post-page">
      <div class="content">
        <div class="width-reduced">
          <h1 class="post-title">
            Version 0.9.4 released
          </h1>
          <h3 class="post-meta">
            <span>
              <i class="far fa-calendar-alt" aria-hidden="true"></i>
              2014年04月21日
            </span>
            
            <span>
              <i class="fa fa-user-circle" aria-hidden="true"></i>
              Dominik Picheta
            </span>
            
          </h3>
          <p>The Nimrod development community is proud to announce the release of version
0.9.4 of the Nimrod compiler and tools. <strong>Note: This release has to be
considered beta quality! Lots of new features have been implemented but
unfortunately some do not fulfill our quality standards yet.</strong></p>

<p>Prebuilt binaries and instructions for building from source are available
on the <a href="/install.html">download page</a>.</p>

<p>This release includes about
<a href="https://github.com/Araq/Nimrod/compare/v0.9.2...v0.9.4">1400 changes</a>
in total including various bug
fixes, new languages features and standard library additions and improvements.
This release brings with it support for user-defined type classes, a brand
new VM for executing Nimrod code at compile-time and new symbol binding
rules for clean templates.</p>

<p>It also introduces support for the brand new
<a href="https://github.com/nimrod-code/babel">Babel package manager</a> which
has itself seen its first release recently. Many of the wrappers that were
present in the standard library have been moved to separate repositories
and should now be installed using Babel.</p>

<p>Apart from that a new <strong>experimental</strong> Asynchronous IO API has been added via
the <code class="highlighter-rouge">asyncdispatch</code> and <code class="highlighter-rouge">asyncnet</code> modules. The <code class="highlighter-rouge">net</code> and <code class="highlighter-rouge">rawsockets</code>
modules have also been added and they will likely replace the sockets
module in the next release. The Asynchronous IO API has been designed to
take advantage of Linux’s epoll and Windows’ IOCP APIs, support for BSD’s
kqueue has not been implemented yet but will be in the future.
The Asynchronous IO API provides both
a callback interface and an interface which allows you to write code as you
would if you were writing synchronous code. The latter is done through
the use of an <code class="highlighter-rouge">await</code> macro which behaves similar to C#’s await. The
following is a very simple chat server demonstrating Nimrod’s new async
capabilities.</p>

<div class="language-nim highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="n">asyncnet</span><span class="p">,</span> <span class="n">asyncdispatch</span>

<span class="k">var</span> <span class="n">clients</span><span class="p">:</span> <span class="kt">seq</span><span class="o">[</span><span class="n">PAsyncSocket</span><span class="o">]</span> <span class="o">=</span> <span class="o">@[]</span>

<span class="k">proc </span><span class="nf">processClient</span><span class="p">(</span><span class="n">client</span><span class="p">:</span> <span class="n">PAsyncSocket</span><span class="p">)</span> <span class="p">{.</span><span class="n">async</span><span class="p">.}</span> <span class="o">=</span>
  <span class="k">while</span> <span class="kp">true</span><span class="p">:</span>
    <span class="k">let</span> <span class="n">line</span> <span class="o">=</span> <span class="n">await</span> <span class="n">client</span><span class="p">.</span><span class="n">recvLine</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">clients</span><span class="p">:</span>
      <span class="n">await</span> <span class="n">c</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">line</span> <span class="o">&amp;</span> <span class="s">"</span><span class="se">\c</span><span class="s">\L"</span><span class="p">)</span>

<span class="k">proc </span><span class="nf">serve</span><span class="p">()</span> <span class="p">{.</span><span class="n">async</span><span class="p">.}</span> <span class="o">=</span>
  <span class="k">var</span> <span class="n">server</span> <span class="o">=</span> <span class="n">newAsyncSocket</span><span class="p">()</span>
  <span class="n">server</span><span class="p">.</span><span class="n">bindAddr</span><span class="p">(</span><span class="n">TPort</span><span class="p">(</span><span class="mi">12345</span><span class="p">))</span>
  <span class="n">server</span><span class="p">.</span><span class="n">listen</span><span class="p">()</span>

  <span class="k">while</span> <span class="kp">true</span><span class="p">:</span>
    <span class="k">let</span> <span class="n">client</span> <span class="o">=</span> <span class="n">await</span> <span class="n">server</span><span class="p">.</span><span class="n">accept</span><span class="p">()</span>
    <span class="n">clients</span><span class="p">.</span><span class="n">add</span> <span class="n">client</span>

    <span class="n">processClient</span><span class="p">(</span><span class="n">client</span><span class="p">)</span>

<span class="n">serve</span><span class="p">()</span>
<span class="n">runForever</span><span class="p">()</span>
</code></pre>
</div>

<p>Note that this feature has been implemented with Nimrod’s macro system and so
<code class="highlighter-rouge">await</code> and <code class="highlighter-rouge">async</code> are no keywords.</p>

<p>Syntactic sugar for anonymous procedures has also been introduced. It too has
been implemented as a macro. The following shows some simple usage of the new
syntax:</p>

<div class="language-nim highlighter-rouge"><pre class="highlight"><code><span class="k">import</span> <span class="n">future</span>

<span class="k">var</span> <span class="n">s</span> <span class="o">=</span> <span class="o">@[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="o">]</span>
<span class="n">echo</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">map</span><span class="p">((</span><span class="n">x</span><span class="p">:</span> <span class="kt">int</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">5</span><span class="p">))</span>
</code></pre>
</div>

<p>A list of changes follows, for a comprehensive list of changes take a look
<a href="https://github.com/Araq/Nimrod/compare/v0.9.2...v0.9.4">here</a>.</p>

<h2 id="library-additions">Library Additions</h2>

<ul>
  <li>Added <code class="highlighter-rouge">macros.genSym</code> builtin for AST generation.</li>
  <li>Added <code class="highlighter-rouge">macros.newLit</code> procs for easier AST generation.</li>
  <li>Added module <code class="highlighter-rouge">logging</code>.</li>
  <li>Added module <code class="highlighter-rouge">asyncdispatch</code>.</li>
  <li>Added module <code class="highlighter-rouge">asyncnet</code>.</li>
  <li>Added module <code class="highlighter-rouge">net</code>.</li>
  <li>Added module <code class="highlighter-rouge">rawsockets</code>.</li>
  <li>Added module <code class="highlighter-rouge">selectors</code>.</li>
  <li>Added module <code class="highlighter-rouge">asynchttpserver</code>.</li>
  <li>Added support for the new asynchronous IO in the <code class="highlighter-rouge">httpclient</code> module.</li>
  <li>Added a Python-inspired <code class="highlighter-rouge">future</code> module that features upcoming additions
to the <code class="highlighter-rouge">system</code> module.</li>
</ul>

<h2 id="changes-affecting-backwards-compatibility">Changes affecting backwards compatibility</h2>

<ul>
  <li>The scoping rules for the <code class="highlighter-rouge">if</code> statement changed for better interaction
with the new syntactic construct <code class="highlighter-rouge">(;)</code>.</li>
  <li><code class="highlighter-rouge">OSError</code> family of procedures has been deprecated. Procedures with the same
name but which take different parameters have been introduced. These procs now
require an error code to be passed to them. This error code can be retrieved
using the new <code class="highlighter-rouge">OSLastError</code> proc.</li>
  <li><code class="highlighter-rouge">os.parentDir</code> now returns “” if there is no parent dir.</li>
  <li>In CGI scripts stacktraces are shown to the user only
if <code class="highlighter-rouge">cgi.setStackTraceStdout</code> is used.</li>
  <li>The symbol binding rules for clean templates changed: <code class="highlighter-rouge">bind</code> for any
symbol that’s not a parameter is now the default. <code class="highlighter-rouge">mixin</code> can be used
to require instantiation scope for a symbol.</li>
  <li><code class="highlighter-rouge">quoteIfContainsWhite</code> now escapes argument in such way that it can be safely
passed to shell, instead of just adding double quotes.</li>
  <li><code class="highlighter-rouge">macros.dumpTree</code> and <code class="highlighter-rouge">macros.dumpLisp</code> have been made <code class="highlighter-rouge">immediate</code>,
<code class="highlighter-rouge">dumpTreeImm</code> and <code class="highlighter-rouge">dumpLispImm</code> are now deprecated.</li>
  <li>The <code class="highlighter-rouge">nil</code> statement has been deprecated, use an empty <code class="highlighter-rouge">discard</code> instead.</li>
  <li><code class="highlighter-rouge">sockets.select</code> now prunes sockets that are <strong>not</strong> ready from the list
of sockets given to it.</li>
  <li>The <code class="highlighter-rouge">noStackFrame</code> pragma has been renamed to <code class="highlighter-rouge">asmNoStackFrame</code> to
ensure you only use it when you know what you’re doing.</li>
  <li>Many of the wrappers that were present in the standard library have been
moved to separate repositories and should now be installed using Babel.</li>
</ul>

<h2 id="compiler-additions">Compiler Additions</h2>

<ul>
  <li>The compiler can now warn about “uninitialized” variables. (There are no
real uninitialized variables in Nimrod as they are initialized to binary
zero). Activate via <code class="highlighter-rouge"><span class="p">{</span><span class="err">.warning[Uninit]:on.</span><span class="p">}</span></code>.</li>
  <li>The compiler now enforces the <code class="highlighter-rouge">not nil</code> constraint.</li>
  <li>The compiler now supports a <code class="highlighter-rouge">codegenDecl</code> pragma for even more control
over the generated code.</li>
  <li>The compiler now supports a <code class="highlighter-rouge">computedGoto</code> pragma to support very fast
dispatching for interpreters and the like.</li>
  <li>The old evaluation engine has been replaced by a proper register based
virtual machine. This fixes numerous bugs for <code class="highlighter-rouge">nimrod i</code> and for macro
evaluation.</li>
  <li><code class="highlighter-rouge">--gc:none</code> produces warnings when code uses the GC.</li>
  <li>A <code class="highlighter-rouge">union</code> pragma for better C interoperability is now supported.</li>
  <li>A <code class="highlighter-rouge">packed</code> pragma to control the memory packing/alignment of fields in
an object.</li>
  <li>Arrays can be annotated to be <code class="highlighter-rouge">unchecked</code> for easier low level
manipulations of memory.</li>
  <li>Support for the new Babel package manager.</li>
</ul>

<h2 id="language-additions">Language Additions</h2>

<ul>
  <li>Arrays can now be declared with a single integer literal <code class="highlighter-rouge">N</code> instead of a
range; the range is then <code class="highlighter-rouge">0..N-1</code>.</li>
  <li>Added <code class="highlighter-rouge">requiresInit</code> pragma to enforce explicit initialization.</li>
  <li>Exported templates are allowed to access hidden fields.</li>
  <li>The <code class="highlighter-rouge">using statement</code> enables you to more easily author domain-specific
languages and libraries providing OOP-like syntactic sugar.</li>
  <li>Added the possibility to override various dot operators in order to handle
calls to missing procs and reads from undeclared fields at compile-time.</li>
  <li>The overload resolution now supports <code class="highlighter-rouge">static[T]</code> params that must be
evaluable at compile-time.</li>
  <li>Support for user-defined type classes has been added.</li>
  <li>The <em>command syntax</em> is supported in a lot more contexts.</li>
  <li>Anonymous iterators are now supported and iterators can capture variables
of an outer proc.</li>
  <li>The experimental <code class="highlighter-rouge">strongSpaces</code> parsing mode has been implemented.</li>
  <li>You can annotate pointer types with regions for increased type safety.</li>
  <li>Added support for the builtin <code class="highlighter-rouge">spawn</code> for easy thread pool usage.</li>
</ul>

<h2 id="tools-improvements">Tools improvements</h2>

<ul>
  <li>c2nim can deal with a subset of C++. Use the <code class="highlighter-rouge">--cpp</code> command line option
to activate.</li>
</ul>

        </div>
      </div>
    </div>
    <footer>
  <section class="content">
    <div class="pure-g">
      <div class="copyright pure-u-2-3">
        <p>
          特に明記のない場合に限り、
          このページのコンテンツの利用条件は
          <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0</a>
          ライセンスです。
          また、このウェブサイトに掲載されているソースコードの利用条件は MIT ライセンスです。
        </p>
        <p>
          このウェブサイトのソースコードは
          <a href="https://github.com/nim-lang/website">GitHub</a>
          にあります。ご貢献を歓迎します。
          ウェブサイトのオリジナルデザインは
          <a href="https://github.com/dom96">Dominik Picheta</a> と
          <a href="https://github.com/Calinou">Hugo Locurcio</a> です。
          ロゴデザインは <a href="https://github.com/josephwecker">Joseph Wecker</a> です。日本語訳は <a href="https://twitter.com/isvowel/">isVowel</a> と <a href="https://osdn.net/projects/nim-lang-081/wiki/Contributors">&#x1f34e;むつさんチーム</a> です。
        </p>
      </div>
      <div class="pure-u-1-3 right-center">
        <a href="https://m.do.co/c/637ab907c7f4"><img src="/assets/img/do.png"/></a>
      </div>
    </div>
  </section>

</footer>
<script>
    (function(){
      function setTracking(a) {
        var url = a.href;
        a.onclick = function() {
          if (typeof(ga) !== "undefined") {
            ga('send', 'event', 'outbound', 'click', url, {
              'transport': 'beacon',
              'hitCallback': function(){document.location = url;}
            });
          }
        };
      }

      var a = document.getElementsByTagName("a");
      for (var i = 0; i < a.length; ++i) {
        if (a[i].hostname != location.hostname &&
            a[i].getAttribute("target") !== "_blank"
        ) {
          setTracking(a[i])
        }
      }
    })();
</script>

  </div>
  </body>
</html>
